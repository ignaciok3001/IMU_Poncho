(function(){var r=function(){var r={},e={exports:r};"use strict";Object.defineProperty(r,"__esModule",{value:true});var t=Object.assign||function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t){if(Object.prototype.hasOwnProperty.call(t,n)){r[n]=t[n]}}}return r};var n={collected:false,uniqueKey:null,speed:undefined,retryTotal:0,cid:{performance:27122,api:27123},version:3};var a=function M(r){var e=document.querySelector('meta[name="'+r+'"]');if(!e)return;return e.getAttribute("content")};var i=function k(){var r=t({},window.__BB);if(r.mode===undefined){var e=r.mode||parseInt(a("bb-mode"));r.mode=isNaN(e)?0:e}if(r.rate===undefined){var i=parseFloat(a("bb-rate"));r.rate=isNaN(i)?100:i}if(r.group===undefined){n.group=a("bb-group")}n.matchRate=Math.round(Math.random()*100)<=r.rate;n.userConfig=r;return n};var o=function A(){if(!n.uniqueKey){n.spmA=a("data-spm")||0;n.spmB=document.body.getAttribute("data-spm")||0;n.uniqueKey=n.spmA+"."+n.spmB}return n.uniqueKey};var u=function j(){return window.performance||window.webkitPerformance||window.msPerformance||window.mozPerformance||{}};var f=function q(){return window.navigator.connection||{}};var s=function z(){var r=f();return r.type||r.effectiveType};var v=function H(){var r=window.localStorage;if(!r)return-1;if(!(n.spmA&&n.spmB))return-2;try{var e="bb_fingerprint";var t="bb_counter_timestamp_"+o();if(!r.getItem(e)){r.setItem(e,(new Date).valueOf());return-9}var a=parseInt(r.getItem(t));var i=isNaN(a)||new Date-new Date(a)>30*24*60*60*1e3;r.setItem(t,(new Date).valueOf());return~~!i}catch(u){return-1}};var c=function P(r){return r>12e4||r<-12e4?0:r};var d=function R(r){if(r.entryType==="navigation")return"html";var e=r.initiatorType;switch(e){case"link":return"css";case"img":return"img";case"script":return/\.alicdn\.com/.test(r.name)?"js":"xhr"}};var p=function K(){var r=u();if(!r.getEntries)return{};var e=r.getEntries()||[];var t={};for(var n=0;n<e.length;n++){var a=e[n];if(a.entryType==="paint"){var i=void 0;if(a.name==="first-paint")i="paint0";if(a.name==="first-contentful-paint")i="paint1";if(i&&a.startTime){var o=parseInt(a.startTime);if(isNaN(o))o=0;t[i]=o}continue}var f=d(a);if(!f)continue;var s=t[f];if(!s){s=t[f]={size:0,total:0,duration:0}}s.total++;s.size+=parseInt(a.transferSize||0);s.duration+=parseInt(a.duration)}return t};var m=function L(){var r=u();if(n.speed!==undefined){return n.speed}if(!r.getEntries){return 0}var e=r.getEntries()||[];var t=e[0];if(!t){return 0}var a=0,i=0;for(var o=0;o<Math.min(e.length,10);o++){var f=t.responseEnd-t.responseStart;var s=t.transferSize||0;if(s<=0||f<=0){continue}a+=s;i+=f}if(i===0||a===0){return 0}var v=a/1024/i*1e3;n.speed=isNaN(v)?0:parseInt(v);return n.speed};var l=function F(r){var e=u();var t=e.timing;return{dns:c(t.domainLookupEnd-t.domainLookupStart),tcp:c(t.connectEnd,t.connectStart),ttfb:c(t.responseStart-t.requestStart),html:c(t.domContentLoadedEventEnd-t.navigationStart),load:c(t.loadEventEnd-t.navigationStart),exposed:r?c(r-t.navigationStart):undefined}};var w=function G(r){if(n.userConfig.stringify===false){return r}var e=[];for(var t in r){if(["paint0","paint1"].indexOf(t)>=0)continue;var a=r[t];e.push(t+"^"+a.total+"."+a.size+"."+a.duration)}return e.join(",")};var g=function J(r,e){e=e||{};var a=t({},r,{spm:o(),v:n.version,netType:s(),speed:m(),group:n.userConfig.group,visit:v(),paint0:e.paint0,paint1:e.paint1,"static":w(e)});return h(a)};var h=function Q(r){if(n.userConfig.stringify===false)return r;var e=[];for(var t in r){var a=r[t];if(a===undefined)continue;e.push(t+"="+a)}return e.join("|")};var y=function U(r,e){if(n.retryTotal>50){return}var a=u();var i=a.timing;if(!i)return;var o=l(r);if(!o)return;if(o.load===0){n.retryTotal++;window.setTimeout(function(){U(r,e)},1e3);return}t(o,e);var f=p();var s=g(o,f);n.performance=s;if(n.collected||!n.matchRate)return;n.collected=true;S(n.cid.performance,s)};var S=function V(r,e){if(window.__BB&&window.__BB.send){window.__BB.send(r,e);return}var t=(window.dmtrack||{}).dotstat;t&&t(r,{ext:e})};var b=function W(r,e){C(r,function(r){if(r){console.warn("BigBrother: Timeout.");e.exposed=-1}y(new Date,e)})};var B=function X(r){var e=0;var t=function n(){var t=window.__BB||{};if(t.exposed)return _(t.exposed,r);if(e++>100)return y(null,r);console.log(e);window.setTimeout(function(){n()},1e3)};t()};var _=function Y(r,e){if(typeof r==="string")r=[r];if(r instanceof Array){b(r,e)}else if(r instanceof Date){y(r,e)}};var x=function Z(r,e){if(n.collected||!n.matchRate)return;var t={};if(e instanceof Array){for(var a=0;a<Math.min(e.length,10);a++){var i=parseInt(e[a]);if(isNaN(i))i=0;t["s"+a]=i}}switch(n.userConfig.mode){case-1:B(t);break;case 1:if(r)_(r,t);break;case 0:y(null,t);break}};var C=function $(r,e){var t=Date.now();var n=20*1e3;if(D(r))return e(false);var a=setInterval(function(){var i=Date.now()-t>n;if(i||D(r)){clearInterval(a);e(i)}},100)};var D=function rr(r){var e=u();if(typeof r==="string")r=[r];if(!e.getEntries)return true;var t=e.getEntries()||[];for(var n=0;n<r.length;n++){if(!E(t,r[n]))return false}return true};var E=function er(r,e){var t=e instanceof RegExp;for(var n=0;n<r.length;n++){var a=r[n].name||"";if(t&&e.test(a)||a.indexOf(e)>=0)return true}return false};var N=function tr(r,e,t,a,i,u){if(!n.matchRate)return;var f=Date.now()-r;if(isNaN(f)||f>10*1e3*60){return}t=Number(t);var s={v:n.version,spm:o(),name:e,duration:Date.now()-r,status:t};if(t===0){s.reason=u;s.path=i}S(n.cid.api,h(s))};var I=function nr(r,e,t){N(r,e,1,t)};var O=function ar(r,e,t,n,a){N(r,e,0,t,n,a)};var T=function ir(){i();x();return{resourcesIsLoaded:D,performance:function r(e,t){x(e||new Date,t)},detectSpeed:m,apiSuccess:I,apiError:O}};r["default"]=T;e.exports=r["default"];return e.exports}();var e=function(){var e={},t={exports:e};t.exports=r;return t.exports}();var t=function(){var r={},t={exports:r};var n=e;window.SCHD_COMS=window.SCHD_COMS||{};if(!window.SCHD_COMS.BigBrother){var a=new n;window.SCHD_COMS.BigBrother=a}t.exports=window.SCHD_COMS.BigBrother;return t.exports}()})();;
